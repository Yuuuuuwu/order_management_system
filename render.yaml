services:
  - type: web
    name: oms-backend
    env: python
    repo: https://github.com/ä½ çš„ç”¨æˆ¶å/ä½ çš„å„²å­˜åº«åç¨±.git
    branch: main
    buildCommand: |
      echo "ğŸš€ é–‹å§‹ Render éƒ¨ç½²æµç¨‹..." &&
      echo "ğŸ“¦ å®‰è£ Python ä¾è³´..." &&
      pip install -r requirements-render.txt &&
      echo "ğŸ” ç’°å¢ƒè®Šæ•¸æª¢æŸ¥:" &&
      echo "   FLASK_ENV: $FLASK_ENV" &&
      echo "   DATABASE_URL: ${DATABASE_URL:0:50}..." &&
      echo "ğŸ—„ï¸ åŸ·è¡Œè³‡æ–™åº«é·ç§»..." &&
      FLASK_ENV=render FLASK_APP=run.py flask db upgrade &&
      echo "ğŸŒ± è¼‰å…¥åˆå§‹è³‡æ–™..." &&
      FLASK_ENV=render python scripts/seed_data.py &&
      echo "âœ… éƒ¨ç½²æº–å‚™å®Œæˆï¼"
    startCommand: |
      echo "ğŸš€ å•Ÿå‹• Flask æ‡‰ç”¨..." &&
      echo "   ç›£è½ç«¯å£: $PORT" &&
      echo "   ç’°å¢ƒ: $FLASK_ENV" &&
      gunicorn --bind 0.0.0.0:$PORT --workers 4 --timeout 120 --access-logfile - --error-logfile - run:app
    plan: free
    environmentVariables:
      - key: FLASK_ENV
        value: render
      - key: FLASK_APP
        value: run.py
      - key: PYTHON_VERSION
        value: 3.11.4
    autoDeploy: true
    
databases:
  - name: oms-postgres
    databaseName: oms_db
    user: oms_db_user
    plan: free